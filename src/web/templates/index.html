<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="viewport", content="width=device-width, initial-scale=1.0">
    <title>Bússola Solar</title>
</head>
<body>
    
    <h1>Bússola Solar</h1>
    <hr>

    <form action="index.php" method="POST" onsubmit="return validatePercentage()">

        <h2>Informações Gerais</h2>

        <label for="inputDate">Data:</label>
        <input type="date" id="inputDate">
        <br><br>

        <label for="inputTime">Horário de Preenchimento:</label>
        <input type="time" id="inputTime">
        <br><br>

        <label for="humor">Como o dia está se iniciando?</label>
        <br>
        <input type="radio" id="sol" name="humor" value="sol">
        <label for="sol">Sol</label>
        <br>

        <input type="radio" id="lua" name="humor" value="lua">
        <label for="lua">Lua</label>
        <br><br>

        <label for="cellphoneTime">Tempo de uso do celular:</label>
        <input type="time" id="cellphoneTime" step="1" max="00:23:59">
        <br><br>

        <h2>Informações de Sono</h2>

        <label for="bedTime">Horário que foi dormir:</label>
        <input type="time" id="bedTime">
        <br><br>

        <label for="wakeupTime">Horário que acordou:</label>
        <input type="time" id="wakeupTime">
        <br><br>

        <label for="awakeSleepTime">Tempo <strong>Acordado</strong> durante a noite:</label>
        <input type="range" id="awakePercentage" name="awakePercentage" min="0" max="50" value="0" oninput="awakePercentageOutput.value = awakePercentage.value">
        <output id="awakePercentageOutput">0</output>%
        <br><br>

        <label for="remSleepTime">Tempo de <strong>Sono REM</strong> durante a noite:</label>
        <input type="range" id="remPercentage" name="remPercentage" min="0" max="50" value="0" oninput="remPercentageOutput.value = remPercentage.value">
        <output id="remPercentageOutput">0</output>%
        <br><br>

        <label for="lightSleepTime">Tempo de <strong>Sono Leve</strong> durante a noite:</label>
        <input type="range" id="lightPercentage" name="lightPercentage" min="0" max="100" value="0" oninput="lightPercentageOutput.value = lightPercentage.value">
        <output id="lightPercentageOutput">0</output>%
        <br><br>

        <label for="deepSleepTime">Tempo de <strong>Sono Pesado</strong> durante a noite:</label>
        <input type="range" id="deepPercentage" name="deepPercentage" min="0" max="50" value="0" oninput="deepPercentageOutput.value = deepPercentage.value">
        <output id="deepPercentageOutput">0</output>%
        <br><br>

        <h2>Informações de Peso</h2>

        <label for="burnedCalories">Calorias queimadas no dia anterior:</label>
        <input type="number" id="burnedCalories" value="0" min="0" oninput="burnedCaloriesOutput.value = burnedCalories.value">
        <output id="burnedCaloriesOutput">0</output> cal
        <br><br>

        <label for="totalWeight">Peso Total:</label>
        <input type="number" id="totalWeight" value="0" name="totalWeight" step="0.01" min="0" max="100" oninput="totalWeightOutput.value = totalWeight.value">
        <output id="totalWeightOutput">0</output> kg
        <br><br>

        <label for="muscleWeight">Massa Magra:</label>
        <input type="number" id="muscleWeight" value="0" name="muscleWeight" step="0.01" min="0" max="100" oninput="muscleWeightOutput.value = muscleWeight.value">
        <output id="muscleWeightOutput">0</output> kg
        <br><br>

        <label for="fatWeightPercentage">Percentual de Gordura:</label>
        <input type="text" id="fatWeightPercentage" value="0" name="fatWeightPercentage" pattern="[0-9]{2}\.[0-9]{2}" title="Por favor, insira a porcentagem de gordura corporal no formato __.__" oninput="fatWeightPercentageOutput.value = fatWeightPercentage.value">
        <output id="fatWeightPercentageOutput">0</output>%
        <br><br>

        <label for="basalMetabolism">Metabolismo basal aproximado:</label>
        <input type="number" id="basalMetabolism" value="1500" min="0" oninput="basalMetabolismOutput.value = basalMetabolism.value">
        <output id="basalMetabolismOutput">1500</output> cal
        <br><br>

        <h2>Definições de Prioridades</h2>

        <table>
            <tr>
                <td><span class="priority-label">Priorizar:</span></td>
                <td><span class="priority-value" id="firstItemStringDisplay"></span></td>
            </tr>
            <tr>
                <td><span class="priority-label">Investir:</span></td>
                <td><span class="priority-value" id="secondItemStringDisplay"></span></td>
            </tr>
            <tr>
                <td><span class="priority-label">Manter:</span></td>
                <td><span class="priority-value" id="forcaIndexDisplay"></span></td>
            </tr>
            <tr>
                <td><span class="priority-label">Despriorizar:</span></td>
                <td><span class="priority-value" id="gentilezaIndexDisplay"></span></td>
            </tr>
            <tr>
                <td><span class="priority-label">Sacrificar:</span></td>
                <td><span class="priority-value" id="devocaoIndexDisplay"></span></td>
            </tr>
        </table>
        

        <br><br>

        <div id="priorityList" class="sortable-list">
            <div class="sortable-item">
                <span class="item-number" id="sabedoria">Sabedoria</span>
            </div>
            <div class="sortable-item">
                <span class="item-number" id="estabilidade">Estabilidade</span>
            </div>
            <div class="sortable-item">
                <span class="item-number" id="forca">Forca</span>
            </div>
            <div class="sortable-item">
                <span class="item-number" id="gentileza">Gentileza</span>
            </div>
            <div class="sortable-item">
                <span class="item-number" id="devocao">Devocao</span>
            </div>
        </div>
        <input type="hidden" id="sabedoria" name="sabedoria">
        <input type="hidden" id="estabilidade" name="estabilidade">
        <input type="hidden" id="forca" name="forca">
        <input type="hidden" id="gentileza" name="gentileza">
        <input type="hidden" id="devocao" name="devocao">
        <br>

        <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.10.2/Sortable.min.js"></script>

        <script>
            var sortableList = document.getElementById("priorityList");
            new Sortable(sortableList, {
                animation: 150
            });
        </script>

        <input type="text" id="gratitude" placeholder="Sou grato por..." minlength="13" required>
        <br><br>

        <input type="reset"><br>
        <input type="submit">
            
    </form>

    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.10.2/Sortable.min.js"></script>
    <script>
        function validatePercentage() {
            var awakePercentage = parseInt(document.getElementById("awakePercentage").value);
            var remPercentage   = parseInt(document.getElementById("remPercentage").value);
            var lightPercentage = parseInt(document.getElementById("lightPercentage").value);
            var deepPercentage  = parseInt(document.getElementById("deepPercentage").value);

            var totalPercentage = awakePercentage + remPercentage + lightPercentage + deepPercentage;

            if (totalPercentage !== 100) {
                alert("A soma das porcentagens deve ser igual a 100%");
                return false;
            }

        return true;
        }

        
        
        var priorityList = document.getElementById("priorityList");
        var items = priorityList.getElementsByClassName("sortable-item");

        var firstItemStringDisplay    = document.getElementById("firstItemStringDisplay");
        var firstItemString = items[0].getElementsByTagName("span")[0].innerText.trim();
        firstItemStringDisplay.textContent = firstItemString;

        var secondItemStringDisplay    = document.getElementById("secondItemStringDisplay");
        var secondItemString = items[1].getElementsByTagName("span")[0].innerText.trim();
        secondItemStringDisplay.textContent = secondItemString;

        var sabedoriaIndexDisplay    = document.getElementById("sabedoriaIndexDisplay");
        var estabilidadeIndexDisplay = document.getElementById("estabilidadeIndexDisplay");
        var forcaIndexDisplay        = document.getElementById("forcaIndexDisplay");
        var gentilezaIndexDisplay    = document.getElementById("gentilezaIndexDisplay");
        var devocaoIndexDisplay      = document.getElementById("devocaoIndexDisplay");

        var sabedoriaIndex    = Array.from(items).findIndex(item => item.getElementsByTagName("span")[0].innerText.trim() === "Sabedoria");
        var estabilidadeIndex = Array.from(items).findIndex(item => item.getElementsByTagName("span")[0].innerText.trim() === "Estabilidade");
        var forcaIndex        = Array.from(items).findIndex(item => item.getElementsByTagName("span")[0].innerText.trim() === "Forca");
        var gentilezaIndex    = Array.from(items).findIndex(item => item.getElementsByTagName("span")[0].innerText.trim() === "Gentileza");
        var devocaoIndex      = Array.from(items).findIndex(item => item.getElementsByTagName("span")[0].innerText.trim() === "Devocao");

        sabedoriaIndexDisplay.textContent    = sabedoriaIndex  + 1;
        estabilidadeIndexDisplay.textContent = estabilidadeIndex  + 1;
        forcaIndexDisplay.textContent        = forcaIndex  + 1;
        gentilezaIndexDisplay.textContent    = gentilezaIndex  + 1;
        devocaoIndexDisplay.textContent      = devocaoIndex  + 1;


        new Sortable(priorityList, {
            animation: 150,
            ghostClass: 'sortable-ghost',
            chosenClass: 'sortable-chosen',
            dragClass: 'sortable-drag',
            onUpdate: function (evt) {
                var items = priorityList.getElementsByClassName("sortable-item");

                var sabedoriaIndexDisplay    = document.getElementById("sabedoriaIndexDisplay");
                var estabilidadeIndexDisplay = document.getElementById("estabilidadeIndexDisplay");
                var forcaIndexDisplay        = document.getElementById("forcaIndexDisplay");
                var gentilezaIndexDisplay    = document.getElementById("gentilezaIndexDisplay");
                var devocaoIndexDisplay      = document.getElementById("devocaoIndexDisplay");

                var firstItemString = items[0].innerText.trim();
                var firstItemStringDisplay = document.getElementById("firstItemStringDisplay");
                firstItemStringDisplay.textContent = firstItemString;

                var sabedoriaIndex    = Array.from(items).findIndex(item => item.getElementsByTagName("span")[0].innerText.trim() === "Sabedoria");
                var estabilidadeIndex = Array.from(items).findIndex(item => item.getElementsByTagName("span")[0].innerText.trim() === "Estabilidade");
                var forcaIndex        = Array.from(items).findIndex(item => item.getElementsByTagName("span")[0].innerText.trim() === "Forca");
                var gentilezaIndex    = Array.from(items).findIndex(item => item.getElementsByTagName("span")[0].innerText.trim() === "Gentileza");
                var devocaoIndex      = Array.from(items).findIndex(item => item.getElementsByTagName("span")[0].innerText.trim() === "Devocao");

                sabedoriaIndexDisplay.textContent    = sabedoriaIndex  + 1;
                estabilidadeIndexDisplay.textContent = estabilidadeIndex  + 1;
                forcaIndexDisplay.textContent        = forcaIndex  + 1;
                gentilezaIndexDisplay.textContent    = gentilezaIndex  + 1;
                devocaoIndexDisplay.textContent      = devocaoIndex  + 1;  
            }
        });
        
    </script>

</body>
</html>
