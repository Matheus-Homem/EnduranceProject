{% extends "base.html" %}

{% block title %}
    Sign Up
{% endblock %}


{% block content %}

    <div class="page-title">
        <h1>Sign Up</h1>
        <h2>Sign Up</h2>
    </div>

    <form action="/register" method="POST" onsubmit="handleSubmit(event)">
        <div class="element-box">
            <div class="element-table">

                <div class="element-row">
                    <div class="element-cell cell-50">
                        <label for="username">Username:</label>
                    </div>
                    <div class="element-cell cell-50">
                        <input type="text" id="username" name="username" required>
                    </div>
                </div>
                <div class="element-row">
                    <div class="element-cell cell-50">
                        <label for="email">Email:</label>
                    </div>
                    <div class="element-cell cell-50">
                        <input type="email" id="email" name="email" required>
                    </div>
                </div>
                <div class="element-row">
                    <div class="element-cell cell-50">
                        <label for="password">Password:</label>
                    </div>
                    <div class="element-cell cell-50">
                        <input type="password" id="password" name="password" required>
                    </div>
                </div>
                <div class="element-row">
                    <div class="element-cell cell-50">
                        <label for="confirm_password">Confirm Password:</label>
                    </div>
                    <div class="element-cell cell-50">
                        <input type="password" id="confirm_password" name="confirm_password" required>
                    </div>
                </div>

            </div>
        </div>

        <div class="buttonContainer">
            <button type="submit" class="loginButton" id="submit">
                <i class="fa-solid fa-pen-to-square"></i>
                Sign Up
            </button>
            <button type="button" class="loginButton" id="login">
                <i class="fa-solid fa-pen-to-square"></i>
                Login
            </button>
        </div>
    </form>

    <script>
        document.getElementById('login').addEventListener('click', function() {
            window.location.href = '/login';
        });

        async function handleSubmit(event) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);
            const response = await fetch(form.action, {
                method: form.method,
                body: formData,
            });

            if (!response.ok) {
                const data = await response.json();
                showError(data.error);
            } else {
                window.location.href = response.url;
            }
        }
    </script>


{% endblock %}